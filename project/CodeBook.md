# Coursera - Getting and Cleaning Data
# Week 4 - Project
## Student:  Narciso Albarracin

### CodeBook.md

#### Overview
The following steps were used to analyze and process the UCI Human Activity Recognition (HAR) data set.  Each step include sub steps that are described in more detail in technical sections as well as within analysis R script.

  1. Merge training and test data sets
  2. For each measurement, only extract only mean and standard deviation
  3. Name variables descriptively
  4. Label datset with descriptive names
  5. From #4, extract tidy data set representing average for each subject and each activity

The input data files at "UCI HAR Dataset" local sub directory are:

* ./features.txt
* ./features_info.txt
* ./activity_labels.txt
* ./train/X_train.txt
* ./train/y_train.txt
* ./train/subject_train.txt
* ./test/X_test.txt
* ./test/y_test.txt
* ./test/subject_test.txt

features.txt, features_info.txt and activity_labels.txt files are code description tables with numeric keys mapped to human readable descriptions.

Training versus test data are split between the training and test folders. File and table structures are identicial between training and test but varying in subjects and activities.  

Subject files include numeric identifiers for test subjects.  The y files are the (predicted) class as activity type (e.g., WALKING, etc.)  The x files are measurements observations stored as feature vectors across columns.

This project manipulates these data inputs as described inmajor steps.  We will load data from files into R, manipulate them and merge, join, select, and filter as necessary to get to a final data set.  The final data set represent tidy data principle and involves joining input file data, renaming columns to be descriptive and apply summary statistical functions such as mean on a limited set of measurement observations for individual mean and standard deviations.

What is an exammple of a relevant data manipulation?  For example, data streams were generated by an Android mobile device and have technical names that will be translated and mapped by run_analysis.R script. 

Although there are other sensor data available such as inertia data.  They are OUT OF SCOPE for this project.

#### Codes and data descriptions

The main entities to understand are subject, activity, and feature.  Subjects are divided into two experiments for training and testing.  Activity maps to Y values and Features map to X values.  The training and testing data sets have 7352 and 2947 observations resulting in a Y (predicted) class of any activity factors in WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, and LAYING using a 561 features.

Features are represented as a feature vector and stored column wise within a flat file table. Each feature or X measurement is named as <measurement>-<attributes>

For example, input data set describes a feature measurement as tBodyAcc-mean() and this can be inferred as "total body acceleration mean value)".

Other measurements can be fully described within UCI HAR directory in README.txt and feature_info.txt files.

##### Final output codes

The final tidy data set codes are below:

 [1] "by.subject"                                  
 [2] "by.activity"                                 
 [3] "Mean-(timeBodyAccMagnitudeMean)"             
 [4] "Mean-(timeBodyAccMagnitudeStdDeviation)"     
 [5] "Mean-(timeGravityAccMagnitudeMean)"          
 [6] "Mean-(timeGravityAccMagnitudeStdDeviation)"  
 [7] "Mean-(timeBodyAccJerkMagnitudeMean)"         
 [8] "Mean-(timeBodyAccJerkMagnitudeStdDeviation)" 
 [9] "Mean-(timeBodyGyroMagnitudeMean)"            
[10] "Mean-(timeBodyGyroMagnitudeStdDeviation)"    
[11] "Mean-(timeBodyGyroJerkMagnitudeMean)"        
[12] "Mean-(timeBodyGyroJerkMagnitudeStdDeviation)"
[13] "Mean-(freqBodyAccMagnitudeMean)"             
[14] "Mean-(freqBodyAccMagnitudeStdDeviation)"     
[15] "Mean-(freqBodyAccJerkMagnitudeMean)"         
[16] "Mean-(freqBodyAccJerkMagnitudeStdDeviation)" 
[17] "Mean-(freqBodyGyroMagnitudeMean)"            
[18] "Mean-(freqBodyGyroMagnitudeStdDeviation)"    
[19] "Mean-(freqBodyGyroJerkMagnitudeMean)"        
[20] "Mean-(freqBodyGyroJerkMagnitudeStdDeviation)"

The first 2 columns: by.subject.id and by.activity.id are grouping columns for subject and activity respectively.  The remaining columns are mean calculation by apply mean function across features that only represent mean and standard deviation at a per feature observation/measurement.

#### Technical Overview, Data Analysis and Processing

The following steps are additionally described within R processing script - run_analysis.R as inline comments.

##### 1. Merge training and test data sets
- 1a. Change working directory to process UCI HAR input data set files.
- 1b. Read files into data frames.
- 1c. Convert data frames into data tables
- 1d. Rename key columns to prepare for merge training and test data tables
- 1e. Create surrogate identity column for merging
- 1f. For training data, merge data tables based on identity column
- 1g. For test data, merge data tables based on identity column
- 1h. Append training and test data tables

##### 2. For each measurement, only extract only mean and standard deviation
- 2a. Set up new data data table for intermediate processing
- 2b. Map feature (descriptive) names to features ids
- 2c. Subset combined data table based on logical vector for required column names (e.g., variable means and standard deviations)

##### 3. Use descriptive activity names to name the activities in the data set
- 3a.  Set up new data data table for intermediate processing
- 3b.  Merge current data table with activities data table based on activity.id key

##### 4. Label data set with descriptive names
- 4a. Set up new data data table for intermediate processing
- 4b. Use regular expressions to match unfriendly names and replace them with friendly names.
- 4c. Rename data table columns

##### 5. From #4, extract tidy data set representing average for each subject and each activity
- 5a. Set up new data data table for intermediate processing
- 5b. Remove unncessary columns prior to computing mean (e.g., activity.name)
- 5c. Compute mean for each measurement by subject.id and activity.id
- 5d. Remove unnecessary columns (i.e., "subject.id", "activity.id")
- 5e. Export tidy data set

#### Example R snippets
The best way to describe this project's code, data and semantics is to see snippets of R script output during the 4 step process.  

"BEFORE - Step 1"" shows snippets of what data input file appear like when loaded into R data frames and data tables.  Finally, "AFTER - Step 4" shows a finalized tidy data table as dt4 prior to exporting and writing into final output file tidy_out.txt.

##### BEFORE (Step #1)
```
>list.dts$features
```

```
V1                                   V2
1:   1                    tBodyAcc-mean()-X
2:   2                    tBodyAcc-mean()-Y
3:   3                    tBodyAcc-mean()-Z
---
559: 559                 angle(X,gravityMean)
560: 560                 angle(Y,gravityMean)
561: 561                 angle(Z,gravityMean)
```
```
>list.dts$activities

V1                 V2
1:  1            WALKING
2:  2   WALKING_UPSTAIRS
3:  3 WALKING_DOWNSTAIRS
4:  4            SITTING
5:  5           STANDING
6:  6             LAYING
```
```
>list.dts$subjects.train
```
```
V1
1:  1
2:  1
3:  1
---
7350: 30
7351: 30
7352: 30
```

```
>list.dts$x.train
```
```
V1           V2          V3         V4          V5          V6         V7          V8
1: 0.2885845 -0.020294171 -0.13290514 -0.9952786 -0.98311061 -0.91352645 -0.9951121 -0.98318457
2: 0.2784188 -0.016410568 -0.12352019 -0.9982453 -0.97530022 -0.96032199 -0.9988072 -0.97491437
3: 0.2796531 -0.019467156 -0.11346169 -0.9953796 -0.96718701 -0.97894396 -0.9965199 -0.96366837
---
7350: 0.2733874 -0.017010616 -0.04502183 -0.2182182 -0.10382198  0.27453270 -0.3045152 -0.09891303
7351: 0.2896542 -0.018843044 -0.15828059 -0.2191394 -0.11141169  0.26889320 -0.3104875 -0.06820033
7352: 0.3515035 -0.012423118 -0.20386717 -0.2692704 -0.08721154  0.17740393 -0.3774040 -0.03867806
```

```
>list.dts$y.train
```

```
1:  5
2:  5
3:  5
---
7350:  2
7351:  2
7352:  2
```

##### AFTER (post step #4)

```
# Tidy data set output as data table.
# Note that by.subject and by.activity are grouping columns used by aggregate function to compute means.
> dt5
```

```
  by.subject by.activity Mean-(timeBodyAccMagnitudeMean) Mean-(timeBodyAccMagnitudeStdDeviation)
1          1           1                      -0.1369712                              -0.2196886
2          2           1                      -0.2904076                              -0.4225442
3          3           1                      -0.2546903                              -0.3284289
4          4           1                      -0.3120506                              -0.5276791
5          5           1                      -0.1583387                              -0.3771787
6          6           1                      -0.1668407                              -0.2667342
  Mean-(timeGravityAccMagnitudeMean) Mean-(timeGravityAccMagnitudeStdDeviation)
1                         -0.1369712                                 -0.2196886
2                         -0.2904076                                 -0.4225442
3                         -0.2546903                                 -0.3284289
4                         -0.3120506                                 -0.5276791
5                         -0.1583387                                 -0.3771787
6                         -0.1668407                                 -0.2667342
  Mean-(timeBodyAccJerkMagnitudeMean) Mean-(timeBodyAccJerkMagnitudeStdDeviation)
1                          -0.1414288                                 -0.07447175
2                          -0.2814242                                 -0.16415099
3                          -0.2800093                                 -0.13991636
4                          -0.3667009                                 -0.31691896
5                          -0.2883330                                 -0.28224228
6                          -0.1951170                                 -0.07060296
  Mean-(timeBodyGyroMagnitudeMean) Mean-(timeBodyGyroMagnitudeStdDeviation)
1                       -0.1609796                               -0.1869784
2                       -0.4465491                               -0.5530199
3                       -0.4664118                               -0.5615107
4                       -0.4977922                               -0.5531161
5                       -0.3559331                               -0.4921768
6                       -0.2812078                               -0.3656029
  Mean-(timeBodyGyroJerkMagnitudeMean) Mean-(timeBodyGyroJerkMagnitudeStdDeviation)
1                           -0.2987037                                   -0.3253249
2                           -0.5479120                                   -0.5577982
3                           -0.5661352                                   -0.5673716
4                           -0.6813040                                   -0.7301464
5                           -0.4445325                                   -0.4891997
6                           -0.3212905                                   -0.3647083
  Mean-(freqBodyAccMagnitudeMean) Mean-(freqBodyAccMagnitudeStdDeviation)
1                      -0.1286235                              -0.3980326
2                      -0.3242894                              -0.5771052
3                      -0.2900315                              -0.4563731
4                      -0.4508046                              -0.6511726
5                      -0.3049925                              -0.5196369
6                      -0.2013866                              -0.4216831
  Mean-(freqBodyAccJerkMagnitudeMean) Mean-(freqBodyAccJerkMagnitudeStdDeviation)
1                         -0.05711940                                 -0.10349240
2                         -0.16906435                                 -0.16409197
3                         -0.18676452                                 -0.08985199
4                         -0.31858781                                 -0.32045870
5                         -0.26948166                                 -0.30568538
6                         -0.05540142                                 -0.09649997
  Mean-(freqBodyGyroMagnitudeMean) Mean-(freqBodyGyroMagnitudeStdDeviation)
1                       -0.1992526                               -0.3210180
2                       -0.5307048                               -0.6517928
3                       -0.5697558                               -0.6326433
4                       -0.6092856                               -0.5939372
5                       -0.4842628                               -0.5897415
6                       -0.3296811                               -0.5106483
  Mean-(freqBodyGyroJerkMagnitudeMean) Mean-(freqBodyGyroJerkMagnitudeStdDeviation)
1                           -0.3193086                                   -0.3816019
2                           -0.5832493                                   -0.5581046
3                           -0.6077516                                   -0.5490870
4                           -0.7243274                                   -0.7577681
5                           -0.5480536                                   -0.4556653
6                           -0.3665005                                   -0.4080789
```
